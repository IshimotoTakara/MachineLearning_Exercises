# VAE（Variational Autoencoder）

## AE(Autoencoder)
### 概要
- 教師なし学習の一つ。そのため学習時の入力データは訓練データのみで教師データは利用しない。
- データを表現する特徴を獲得するためのニューラルネットワーク。
![image](https://user-images.githubusercontent.com/57268381/141604307-48fe2dad-54e3-4f4c-a6b7-391b47a62426.png)
【オートエンコーダーの処理手順】

1.入力データ（上図では手書き数字画像データ）x を、エンコーダー（ニューラルネットワーク）で潜在変数 z に変換する。  
この様子は、見方を変えると入力データの符号化しているようにみなせるため、この入力データを変換するニューラルネットワークをエンコーダーと呼ぶ。  
又、潜在変数 z の次元が、入力データ x より小さい場合、このエンコーダーでの処理は次元削除になっているとみなすことも出来る。
1.潜在変数 z を、デコーダー（ニューラルネットワーク）に入力し、元の画像に再変換する。  
この様子は、見方を変えるとエンコーダーで符号化した潜在変数を、再度（入力データである画像に）復号化しているようにみなせるため、この潜在変数を変換するニューラルネットワークをデコーダーと呼ぶ。

## VAE(Variational Autoencoder)
オートエンコーダーの内、以下のようなアーキテクチャ図のように、潜在変数 z を生成する分布が、正規分布 N(0,1) であるように設定した（ z~N(0,1) ）オートエンコーダーを、VAEという。（これに対して、通常の AutoEncoder は潜在変数 z を生成する分布を仮定していない。）  
※ より厳密な言い方をすれば、VAE では、この事後分布 q_ϕ(z|x) と事前分布 p_θ(z) の間のKLダイバージェンスを解析的に計算可能にするために、事前分布 p_θ(z) が正規分布に従っていると仮定する。
![image](https://user-images.githubusercontent.com/25688193/65937265-4fe35980-e45a-11e9-872c-0fc8cbaab59c.png)
※ ここで、VAE におけるエンコーダーは、正規分布に従う潜在変数 z を直接出力するのではなく、潜在変数 z が従う正規分布の平均値 μ(x) と分散値 σ(x) を生成していることに注意。